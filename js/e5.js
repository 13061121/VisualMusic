define(["analyser","util"],function(a,b){function c(){this.x=Math.round(Math.random()*r.width),this.y=Math.round(Math.random()*r.height),this.rad=Math.round(10*Math.random())+15,this.rgba=v[b.intRandom(0,5)],this.vx=Math.round(3*Math.random())-1.5,this.vy=Math.round(3*Math.random())-1.5}function d(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))}function e(){for(s.save(),h=a.getData(),m=h.length/2,s.clearRect(0,0,r.width,r.height),s.globalCompositeOperation="lighter",s.linewidth=.5,k=0,o=0;m>k;k++)o+=h[k];for(p=o/m,k=0;m>k;k++){for(i=t[k],n=1,l=0;m>l;l++)j=t[l],i.rgba==j.rgba&&d(i,j)<p&&(s.strokeStyle=i.rgba,s.beginPath(),s.moveTo(i.x,i.y),s.lineTo(j.x,j.y),s.stroke(),n+=.6);s.fillStyle=i.rgba,s.strokeStyle=i.rgba,s.beginPath(),s.arc(i.x,i.y,i.rad*n,0,2*Math.PI,!0),s.fill(),s.closePath(),s.beginPath(),s.arc(i.x,i.y,(i.rad+5)*n,0,2*Math.PI,!0),s.stroke(),s.closePath(),i.x+=i.vx,i.y+=i.vy,i.x>r.width+i.rad&&(i.x=0),i.x<-i.rad&&(i.x=r.width),i.y>r.height+i.rad&&(i.y=0),i.y<-i.rad&&(i.y=r.height)}s.restore()}function f(){b.setBg(5);for(var a=0;u>a;a++)t.push(new c);w=!0}function g(){return w}var h,i,j,k,l,m,n,o,p,q="e5.jpg",r=b.getById("visual-canvas"),s=r.getContext("2d"),t=[],u=a.getFftSize()/4,v=["#f35d4f","#f36849","#c0d988","#6ddaf1","#f1e85b"],w=!1;return{draw:e,init:f,isInit:g,cover:q}});