define(["analyser","util"],function(a,b){function c(){for(s.save(),g=a.getData(),h=r.width,i=r.height,m=i/2,s.clearRect(0,0,h,i),j=0;v>j;j++)u[j]=g[j]*t[j];for(s.shadowColor="#fffa47",s.shadowBlur=15,s.strokeStyle=p,s.lineWidth=2,s.beginPath(),k=0,l=Math.ceil(h/v),s.moveTo(k,m),j=1;v-2>j;j++)n=(k+k+l)/2,o=m-(u[j]+u[j+1])/2,s.quadraticCurveTo(k,m-u[j],n,o),k+=l;s.quadraticCurveTo(k,m-u[j],k+l,m-u[j+1]),s.stroke(),s.restore()}function d(){b.setBg(8);var a=.1*Math.random()+.05,c=0;for(t[0]=Math.sin(c),j=1;v>j;j++)t[j]=Math.sin(c),(t[j-1]>0&&t[j]<0||t[j-1]<0&&t[j]>0)&&(a=.1*Math.random()+.05),c+=a;e(),w=!0}function e(){p=s.createLinearGradient(0,0,0,r.height),p.addColorStop(.1,"#ff5614"),p.addColorStop(.3,"#fffa47"),p.addColorStop(.4,"#f93b04"),p.addColorStop(.5,"#f93b04"),p.addColorStop(.6,"#fffa47"),p.addColorStop(.7,"#f93b04"),p.addColorStop(.75,"#f01800"),p.addColorStop(.8,"#fb7220"),p.addColorStop(.9,"#f93b04"),p.addColorStop(1,"#f01800")}function f(){return w}var g,h,i,j,k,l,m,n,o,p,q="e8.jpg",r=b.getById("visual-canvas"),s=r.getContext("2d"),t=[],u=[],v=a.getFftSize()/2-20,w=!1;return $(window).resize(function(){e()}),{draw:c,init:d,isInit:f,cover:q}});