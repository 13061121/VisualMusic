define(["analyser","util"],function(a,b){function c(){for(j.save(),f=a.getData(),j.clearRect(0,0,i.width,i.height),l=0,k=f.length;k>l;l+=5){g=n[l],0==g.size?g.size=f[l]:g.size<f[l]?(g.size+=Math.floor((f[l]-g.size)/5),g.opacity=g.opacity+.02,g.opacity>1&&(g.opacity=1)):(g.size-=Math.floor((g.size-f[l])/5),0==f[l]?g.opacity=0:(g.opacity=g.opacity-.02,g.opacity<0&&(g.opacity=0,g.x=Math.random()*i.width,g.y=Math.random()*i.height)));var b=g.color.replace("0)",g.opacity+")");j.fillStyle=b,j.beginPath(),j.arc(g.x,g.y,g.size,0,2*Math.PI,!0),j.closePath(),j.fill()}j.restore()}function d(){b.setBg(0);var c,d=a.getFftSize()/2,e=i.width,f=i.height,g=o.length;for(c=0;d>c;c++)n[c]={x:Math.random()*e,y:Math.random()*f,color:"rgba("+o[Math.floor(Math.random()*g)]+", 0)",size:0,opacity:Math.random()+.2};m=!0}function e(){return m}var f,g,h="e0.jpg",i=b.getById("visual-canvas"),j=i.getContext("2d"),k=0,l=0,m=!1,n=[],o=["105, 210, 231","27, 103, 107","190, 242, 2","235, 229, 77","0, 205, 172","22, 147, 165","249, 212, 35","255, 78, 80","231, 32, 78","12, 202, 186","255, 0, 111"];return{draw:c,init:d,isInit:e,cover:h}});