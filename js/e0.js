define(["analyser","util"],function(a,b){function c(){for(i.save(),f=a.getData(),i.clearRect(0,0,h.width,h.height),k=0,j=f.length;j>k;k+=5){g=m[k],0==g.size?g.size=f[k]:g.size<f[k]?(g.size+=Math.floor((f[k]-g.size)/5),g.opacity=g.opacity+.02,g.opacity>1&&(g.opacity=1)):(g.size-=Math.floor((g.size-f[k])/5),0==f[k]?g.opacity=0:(g.opacity=g.opacity-.02,g.opacity<0&&(g.opacity=0,g.x=Math.random()*h.width,g.y=Math.random()*h.height)));var b=g.color.replace("0)",g.opacity+")");i.fillStyle=b,i.beginPath(),i.arc(g.x,g.y,g.size,0,2*Math.PI,!0),i.closePath(),i.fill()}i.restore()}function d(){b.setBg(0);var c,d=a.getFftSize()/2,e=h.width,f=h.height,g=n.length;for(c=0;d>c;c++)m[c]={x:Math.random()*e,y:Math.random()*f,color:"rgba("+n[Math.floor(Math.random()*g)]+", 0)",size:0,opacity:Math.random()+.2};l=!0}function e(){return l}var f,g,h=b.getById("visual-canvas"),i=h.getContext("2d"),j=0,k=0,l=!1,m=[],n=["105, 210, 231","27, 103, 107","190, 242, 2","235, 229, 77","0, 205, 172","22, 147, 165","249, 212, 35","255, 78, 80","231, 32, 78","12, 202, 186","255, 0, 111"];return{draw:c,init:d,isInit:e}});