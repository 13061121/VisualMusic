define(["analyser","util"],function(a,b){function c(){var b=0,c=0;for(f=a.getData(),j.clearRect(0,0,i.width,i.height),g=0;64>g;g++)h=k[g],0==h.h?h.h=f[g]:h.h<f[g]?h.h+=Math.floor((f[g]-h.h)/2):h.h-=Math.floor((h.h-f[g])/1.2),j.fillStyle="rgba("+h.color+", 0.8)",h.h*=1.8,j.fillRect(h.x,i.height-h.h,h.w,h.h),l[g]<h.h?l[g]=h.h:l[g]--,j.fillStyle=j.fillStyle.replace("0.8)","0.5)"),j.fillRect(h.x,i.height-l[g]-h.w,h.w,h.w),b+=f[g];c=Math.floor(b/64),j.fillStyle="rgba(255, 255, 255, 0.5)",j.fillRect(0,i.height-c,i.width,c),j.fillRect(i.width-c,0,c,i.height),j.fillRect(0,0,i.width,c),j.fillRect(0,0,c,i.height)}function d(){b.setBg(1);for(var a=i.width,c=(i.height,m.length,Math.ceil(a/64)),d=0;64>d;d++)l[d]=0,k[d]={x:d*c,w:c,h:0,color:m[Math.floor(Math.random()*m.length)]};n=!0}function e(){return n}var f,g,h,i=b.getById("visual-canvas"),j=i.getContext("2d"),k=[],l=[],m=["157, 193, 243","245, 232, 153","226, 51, 110"],n=!1;return{draw:c,init:d,isInit:e}});