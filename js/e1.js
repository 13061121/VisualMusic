define(["analyser","util"],function(a,b){function c(){var b=0,c=0;for(f=a.getData(),k.clearRect(0,0,j.width,j.height),g=0;64>g;g++)h=l[g],0==h.h?h.h=f[g]:h.h<f[g]?h.h+=Math.floor((f[g]-h.h)/2):h.h-=Math.floor((h.h-f[g])/1.2),k.fillStyle="rgba("+h.color+", 0.8)",h.h*=1.8,k.fillRect(h.x,j.height-h.h,h.w,h.h),m[g]<h.h?m[g]=h.h:m[g]--,k.fillStyle=k.fillStyle.replace("0.8)","0.5)"),k.fillRect(h.x,j.height-m[g]-h.w,h.w,h.w),b+=f[g];c=Math.floor(b/64),k.fillStyle="rgba(255, 255, 255, 0.5)",k.fillRect(0,j.height-c,j.width,c),k.fillRect(j.width-c,0,c,j.height),k.fillRect(0,0,j.width,c),k.fillRect(0,0,c,j.height)}function d(){b.setBg(1);for(var a=j.width,c=(j.height,n.length,Math.ceil(a/64)),d=0;64>d;d++)m[d]=0,l[d]={x:d*c,w:c,h:0,color:n[Math.floor(Math.random()*n.length)]};o=!0}function e(){return o}var f,g,h,i="e1.jpg",j=b.getById("visual-canvas"),k=j.getContext("2d"),l=[],m=[],n=["157, 193, 243","245, 232, 153","226, 51, 110"],o=!1;return{draw:c,init:d,isInit:e,cover:i}});