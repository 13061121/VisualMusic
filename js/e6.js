define(["analyser","util"],function(a,b){function c(){this.c=p[b.intRandom(0,p.length)],this.a=q,q>0&&(q-=4)}function d(){m.save(),g=a.getData(),i=g.length/2-32;var b=l.width/12;for(k=b,m.clearRect(0,0,l.width,l.height),h=16;i>h;h+=4)m.fillStyle=n[h].c,j=g[h]+n[h].a,m.fillRect(0,l.height-j,k,j),k<l.width&&(k+=b);m.restore()}function e(){for(b.setBg(6),h=0;o>h;h++)n.push(new c);r=!0}function f(){return r}var g,h,i,j,k,l=b.getById("visual-canvas"),m=l.getContext("2d"),n=[],o=a.getFftSize()/2,p=["rgba(217, 54, 57, 0.8)","rgba(247, 209, 74, 0.8)","rgba(166, 235, 54, 0.8)","rgba(66, 215, 237, 0.8)","rgba(44, 126, 225, 0.8)","rgba(173, 81, 224, 0.8)"],q=300,r=!1;return{draw:d,init:e,isInit:f}});